# Suppression of odor processing connectomics (Leier, Jonaitis & Foden et al., 2025)


## Overview

This project compares synaptic connectivity of Or42a and Or43b Olfactory Sensory Neurons (OSNs) and Projection Neurons (PNs) within the Drosophila brain using Flywire data. It identifies key synaptic partners of Or42a and Or43b OSNs, quantifies their synaptic contributions, and visualizes neuron skeletons in a 2D brain context.

## Features

-   **OSN & PN Data Retrieval:** Programmatically access and filter neuron data for specific OSN and PN types (Or42a, Or43b, VM7d, VM2) from Flywire.
-   **Synaptic Partner Identification:** Identify pre- and post-synaptic partners for selected OSNs.
-   **Synaptic Quantification:** Calculate and quantify synaptic inputs and outputs between OSNs and their partners, including proportional contributions by cell type.
-   **Connectivity Visualization:** Generate pie charts illustrating synaptic input/output proportions for OSNs.
-   **Neuron Skeleton Visualization:** Plot 2D skeletons of specific OSNs and PNs within the Drosophila brain context, saved as scalable SVG files.

## Usage

The analysis is structured into two main parts: data processing and visualization, handled by separate R and Python scripts/notebooks.

**R Analysis (.Rmd file)**

The R Markdown file handles the bulk of the data retrieval and synaptic quantification.

1. **Open the R Markdown file:** Open the provided .Rmd file in RStudio.
2. **Run the chunks:** Execute the R code chunks sequentially.
    -   This will retrieve neuron metadata.
    -   Filter for specified OSN and PN types.
    -   Find pre- and post-synaptic partners for OSNs.
    -   Calculate synaptic inputs and outputs.
    _   Generate and save the connectivity pie charts (.eps file).
    -   Save CSV files containing specific neuron IDs for Python visualization (e.g., Or42a_OSN_ids.csv, VM7d_PN_ids.csv).

**Python Visualization (.ipynb file)**

The Jupyter Notebook is used for visualizing neuron skeletons.

1. **Open the .ipynb file:** Navigate to and open the provided Jupyter Notebook in your browser.
2. **Run the cells:** Execute the cells sequentially.
    -   This will read the CSV files generated by the R analysis.
    -   Retrieve 3D neuron skeletons from Flywire.
    -   Plot 2D projections of these skeletons on the Drosophila brain background.
    -   Save these visualizations as scalable SVG files.

## Project Structure

    ├── data/                                                       # All CSV files used in the project   
    ├── figures/                                                    # Figures included in the paper  
    ├── suppression-of-odor-processing-connectomics.Rmd             # RMarkdown file containing the data analysis
    ├── suppression-of-odor-processing-neuron-skeletons.ipynb       # Jupyter notebook used to create neuron skeleton images    
